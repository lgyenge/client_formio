import{a as N,b as I,c as C,d as ie,e as oe,f as re,g as ne,h as se,i as ae}from"./chunk-M3WMEOGD.js";import{a as K,b as W,c as X,f as Z,g as ee,j as x,k as te}from"./chunk-4V3EDDW7.js";import{$ as v,Ea as z,Ga as w,I as d,J as l,Ja as J,Oa as y,Pa as D,Qa as L,R as g,Ra as A,Sa as V,T as m,Ta as G,Ua as ve,W as a,X as s,Y as c,_ as S,a as j,aa as p,d as B,ea as R,fa as O,fb as ge,ga as Q,gb as Y,ha as T,ia as u,ob as H,p as E,ra as U,t as b,u as M,xa as $,y as f,z as h}from"./chunk-CKFQCT3F.js";var ce=B(ve());var be=["search"];function ye(o,i){if(o&1){let n=S();a(0,"span",6),v("click",function(){f(n);let e=p(2);return h(e.clearSearch())}),c(1,"span",7),s()}}function Ce(o,i){if(o&1){let n=S();a(0,"div",3)(1,"input",4,0),v("keyup",function(){f(n);let e=p();return h(e.onSearch())}),s(),g(3,ye,2,0,"span",5),s()}if(o&2){let n=T(2);d(3),m("ngIf",n&&n.value!=="")}}function Se(o,i){if(o&1){let n=S();a(0,"formio-grid",8),v("rowAction",function(e){f(n);let r=p();return h(r.onAction(e))})("rowSelect",function(e){f(n);let r=p();return h(r.onSelect(e))})("createItem",function(){f(n);let e=p();return h(e.onCreateItem())}),s()}if(o&2){let n=p();m("formio",n.serviceFormioConverted)("gridType","form")("query",n.gridQuery)("isActionAllowed",n.service.actionAllowed)}}var le=(()=>{let i=class i{constructor(t,e,r,_){this.service=t,this.route=e,this.router=r,this.config=_,this.serviceFormioConverted=this.service.formio;let k=new I;this.config=j(j({},k),this.config),this.gridQuery={type:this.config.type,sort:"title"},this.config.tag&&(this.gridQuery.tags=this.config.tag),this.onSearch=(0,ce.debounce)(this._onSearch,300)}loadGrid(){let t=localStorage.getItem("query");t!==null&&(this.gridQuery=JSON.parse(t));let e=+(localStorage.getItem("currentPage")||0);this.formGrid.refreshGrid(this.gridQuery).then(()=>this.formGrid.setPage(e-1))}ngOnInit(){this.gridQuery={type:this.config.type,sort:"title"},this.config.tag&&(this.gridQuery.tags=this.config.tag),this.service.reset(),this.service.ready.then(()=>{this.loadGrid(),this.formGrid.footer.pageChanged.subscribe(t=>{localStorage.setItem("currentPage",t.page)})})}ngAfterViewInit(){this.searchElement.nativeElement.value=localStorage.getItem("searchInput")||""}_onSearch(){let t=this.searchElement.nativeElement.value;t.length>0?(this.gridQuery.skip=0,this.gridQuery.title__regex="/"+t+"/i",this.gridQuery.title__regex="/"+t.trim()+"/i"):delete this.gridQuery.title__regex,localStorage.setItem("query",JSON.stringify(this.gridQuery)),localStorage.setItem("searchInput",t),this.formGrid.pageChanged({page:1,itemPerPage:this.gridQuery.limit})}clearSearch(){this.gridQuery={type:this.config.type,sort:"title"},this.config.tag&&(this.gridQuery.tags=this.config.tag),localStorage.removeItem("query"),localStorage.removeItem("searchInput"),localStorage.removeItem("currentPage"),this.searchElement?.nativeElement&&(this.searchElement.nativeElement.value=""),this.formGrid.query=this.gridQuery,this.formGrid.pageChanged({page:1})}onAction(t){this.service.form=null,this.router.navigate([t.row._id,t.action],{relativeTo:this.route})}onSelect(t){this.router.navigate(["/sheet",t._id])}onCreateItem(){this.router.navigate(["create"],{relativeTo:this.route})}};i.\u0275fac=function(e){return new(e||i)(l(C),l(y),l(L),l(I))},i.\u0275cmp=b({type:i,selectors:[["app-display-form"]],viewQuery:function(e,r){if(e&1&&(R(be,5),R(x,5)),e&2){let _;O(_=Q())&&(r.searchElement=_.first),O(_=Q())&&(r.formGrid=_.first)}},decls:2,vars:2,consts:[["search",""],["role","search","class","input-group mb-3",4,"ngIf"],[3,"formio","gridType","query","isActionAllowed","rowAction","rowSelect","createItem",4,"ngIf"],["role","search",1,"input-group","mb-3"],["type","text","placeholder","Search Forms","aria-label","Search Forms","aria-describedby","button-search",1,"form-control",3,"keyup"],["class","form-clear input-group-addon",3,"click",4,"ngIf"],[1,"form-clear","input-group-addon",3,"click"],[1,"fa","fa-times","bi","bi-x"],[3,"rowAction","rowSelect","createItem","formio","gridType","query","isActionAllowed"]],template:function(e,r){e&1&&g(0,Ce,4,1,"div",1)(1,Se,1,4,"formio-grid",2),e&2&&(m("ngIf",r.config.includeSearch),d(),m("ngIf",r.service.ready))},dependencies:[w,x],styles:[".form-clear[_ngcontent-%COMP%]{background:#cecece;border-radius:50%;bottom:8px;color:#0000004d;cursor:pointer;display:flex;justify-content:center;align-items:center;padding-bottom:2px;height:24px;position:absolute;right:10px;top:6px;width:24px;z-index:10}.form-clear[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{font-size:16px;font-weight:500}"]});let o=i;return o})();function we(o,i){o&1&&(a(0,"li",4)(1,"a",8),c(2,"em",9),u(3," Edit"),s()())}function xe(o,i){o&1&&(a(0,"li",4)(1,"a",10),c(2,"span",11),s()())}var pe=(()=>{let i=class i{constructor(t,e){this.service=t,this.route=e}setDownloadUrl(t){this.downloadUrl=t}ngOnInit(){this.service.setSubmission(this.route).then(t=>{t.getDownloadUrl().then(e=>this.setDownloadUrl(e))})}};i.\u0275fac=function(e){return new(e||i)(l(C),l(y))},i.\u0275cmp=b({type:i,selectors:[["app-submission"]],decls:11,vars:2,consts:[["aria-label","Submission","role","navigation",1,"nav","nav-tabs",2,"margin-bottom","10px"],[1,"nav-item"],["routerLink","../",1,"nav-link"],[1,"fa","fa-chevron-left","bi","bi-chevron-left"],["routerLinkActive","active",1,"nav-item"],["routerLink","view","routerLinkActive","active",1,"nav-link"],[1,"fa","fa-eye","bi","bi-eye"],["class","nav-item","routerLinkActive","active",4,"ngIf"],["routerLink","edit","routerLinkActive","active",1,"nav-link"],[1,"fa","fa-edit","bi","bi-pencil-square"],["routerLink","delete","routerLinkActive","active",1,"nav-link"],[1,"fa","fa-trash","bi","bi-trash"]],template:function(e,r){e&1&&(a(0,"ul",0)(1,"li",1)(2,"a",2),c(3,"em",3),s()(),a(4,"li",4)(5,"a",5),c(6,"em",6),u(7," View"),s()(),g(8,we,4,0,"li",7)(9,xe,3,0,"li",7),s(),c(10,"router-outlet")),e&2&&(d(8),m("ngIf",r.service.perms.edit),d(),m("ngIf",r.service.perms.delete))},dependencies:[w,D,A,V],encapsulation:2});let o=i;return o})();var de=o=>({active:o});function Ie(o,i){if(o&1){let n=S();a(0,"button",12),v("click",function(){f(n);let e=p(),r=T(17);return h(e.openEmbed(r))}),c(1,"em",13),u(2," Share"),s()}}function ke(o,i){o&1&&(a(0,"li",6)(1,"a",14),c(2,"em",15),u(3," Edit Form"),s()())}function Fe(o,i){o&1&&(a(0,"li",6)(1,"a",16),c(2,"span",17),s()())}function Ee(o,i){if(o&1&&(a(0,"pre"),c(1,"textarea",31),s()),o&2){let n=p(2);d(),m("ngModel",n.embedCode)}}function Me(o,i){if(o&1&&c(0,"input",32),o&2){let n=p(2);m("ngModel",n.shareUrl)}}function Te(o,i){if(o&1){let n=S();a(0,"div",18)(1,"h4",19),u(2,"Share or Embed this form"),s(),a(3,"button",20),v("click",function(){f(n);let e=p();return h(e.modalRef.hide())}),a(4,"span",21),u(5,"\xD7"),s()()(),a(6,"div",22)(7,"ul",23)(8,"li",3)(9,"a",24),v("click",function(){f(n);let e=p();return h(e.choices("isUrl"))}),c(10,"em",25),u(11," URL"),s()(),a(12,"li",3)(13,"a",24),v("click",function(){f(n);let e=p();return h(e.choices("isEmbed"))}),c(14,"em",26),u(15," Embed"),s()()(),g(16,Ee,2,1,"pre",27)(17,Me,1,1,"input",28),s(),a(18,"div",29)(19,"button",30),v("click",function(){f(n);let e=p();return h(e.modalRef.hide())}),u(20,"Close"),s()()}if(o&2){let n=p();d(9),m("ngClass",U(4,de,n.choice==="isUrl")),d(4),m("ngClass",U(6,de,n.choice==="isEmbed")),d(3),m("ngIf",n.choice==="isEmbed"),d(),m("ngIf",n.choice==="isUrl")}}var ue=(()=>{let i=class i{constructor(t,e,r,_,k){this.service=t,this.route=e,this.appConfig=r,this.options=_,this.modalService=k,this.choice="isUrl",this.goTo=""}ngOnInit(){this.service.reset(this.route),this.service.loadForm().then(t=>{this.service.formSrc=this.appConfig.appUrl+"/"+t.path,this.projectId=t.project,this.pathName=t.path,this.getShareUrl()})}getShareUrl(){let t=this.appConfig.appUrl+"/"+this.pathName;return this.shareUrl=`${this.options.viewer}/#/?src=${encodeURIComponent(t)}`,this.shareUrl}openEmbed(t){let e="";this.goTo&&(e+=`if (d && d.formSubmission && d.formSubmission._id) { window.location.href = "${this.goTo}";}`);let r='<script type="text/javascript">';r+="(function a(d, w, u) {",r+='var h = d.getElementsByTagName("head")[0];',r+='var s = d.createElement("script");',r+='s.type = "text/javascript";',r+='s.src = "'+this.options.viewer+'/assets/lib/seamless/seamless.parent.min.js";',r+="s.onload = function b() {",r+='var f = d.getElementById("formio-form-'+this.service.formio.formId+'");',r+="if (!f || (typeof w.seamless === u)) {",r+="return setTimeout(b, 100);",r+="}",r+="w.seamless(f, {fallback:false}).receive(function(d, e) {"+e+"});",r+="};",r+="h.appendChild(s);",r+="})(document, window);",r+="<\/script>",r+='<iframe id="formio-form-'+this.service.formio.formId+'" ',r+='style="width:100%;border:none;" height="800px" src="'+this.shareUrl+'&iframe=1"></iframe>',this.embedCode=r,this.modalRef=this.modalService.show(t,{class:"modal-lg"})}choices(t){this.choice=t}};i.\u0275fac=function(e){return new(e||i)(l(C),l(y),l(Y),l(I),l(N))},i.\u0275cmp=b({type:i,selectors:[["app-sheet-new"]],decls:18,vars:3,consts:[["content",""],["class","float-end btn btn-outline-primary",3,"click",4,"ngIf"],[1,"nav","nav-tabs","mb-2"],[1,"nav-item"],["routerLink","../",1,"nav-link"],[1,"fa","fa-chevron-left","bi","bi-chevron-left"],["routerLinkActive","active",1,"nav-item"],["routerLink","view","routerLinkActive","active",1,"nav-link"],[1,"fa","fa-pencil","bi","bi-pencil"],["routerLink","submission","routerLinkActive","active",1,"nav-link"],[1,"fa","fa-list-alt","bi","bi-table"],["class","nav-item","routerLinkActive","active",4,"ngIf"],[1,"float-end","btn","btn-outline-primary",3,"click"],[1,"fa","fa-share-alt","bi","bi-share"],["routerLink","edit","routerLinkActive","active",1,"nav-link"],[1,"fa","fa-edit","bi","bi-pencil-square"],["routerLink","delete","routerLinkActive","active",1,"nav-link"],[1,"fa","fa-trash","bi","bi-trash"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"nav","nav-tabs","mr-auto","mb-2"],[1,"nav-link",3,"click","ngClass"],[1,"fa","fa-link","bi","bi-link"],[1,"fa","fa-code","bi","bi-code-slash"],[4,"ngIf"],["type","text","onclick","this.focus();this.select()","readonly","readonly","class","form-control","placeholder","https://examples.form.io/example",3,"ngModel",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["onclick","this.focus();this.select()","readonly","readonly","rows","8",2,"width","100%",3,"ngModel"],["type","text","onclick","this.focus();this.select()","readonly","readonly","placeholder","https://examples.form.io/example",1,"form-control",3,"ngModel"]],template:function(e,r){e&1&&(g(0,Ie,3,0,"button",1),a(1,"ul",2)(2,"li",3)(3,"a",4),c(4,"em",5),s()(),a(5,"li",6)(6,"a",7),c(7,"em",8),u(8," Enter Data"),s()(),a(9,"li",6)(10,"a",9),c(11,"em",10),u(12," View Data"),s()(),g(13,ke,4,0,"li",11)(14,Fe,3,0,"li",11),s(),c(15,"router-outlet"),g(16,Te,21,8,"ng-template",null,0,$)),e&2&&(m("ngIf",r.options.viewer),d(13),m("ngIf",r.service.actionAllowed("formEdit")),d(),m("ngIf",r.service.actionAllowed("formDelete")))},dependencies:[z,w,D,A,V,K,W,X],encapsulation:2});let o=i;return o})();var fe=(()=>{let i=class i{constructor(t,e,r){this.service=t,this.route=e,this.router=r,this.serviceFormioConverted=this.service.formio}ngOnInit(){}onSelect(t){this.router.navigate([t._id,"view"],{relativeTo:this.route})}};i.\u0275fac=function(e){return new(e||i)(l(C),l(y),l(L))},i.\u0275cmp=b({type:i,selectors:[["app-submission-index"]],decls:1,vars:1,consts:[[3,"rowSelect","formio"]],template:function(e,r){e&1&&(a(0,"formio-grid",0),v("rowSelect",function(k){return r.onSelect(k)}),s()),e&2&&m("formio",r.serviceFormioConverted)},dependencies:[x],encapsulation:2});let o=i;return o})();var De=[{path:"",component:le},{path:":id",component:ue,children:[{path:"",redirectTo:"view",pathMatch:"full"},{path:"view",component:oe},{path:"edit",component:ie},{path:"delete",component:re},{path:"submission",component:fe},{path:"submission/:id",component:pe,children:[{path:"",redirectTo:"view",pathMatch:"full"},{path:"view",component:ae},{path:"edit",component:ne},{path:"delete",component:se}]}]}],he=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=M({type:i}),i.\u0275inj=E({imports:[G.forChild(De),G]});let o=i;return o})();var Le=B(ge());var Et=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=M({type:i}),i.\u0275inj=E({providers:[N],imports:[J,he,H,te,ee,Z]});let o=i;return o})();export{Et as SheetModule};
